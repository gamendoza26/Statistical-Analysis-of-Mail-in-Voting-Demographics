---
title: "So on and so Forth Final Project"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: false
---

**Introduction and data:**

We have used a data set from the American National Election Studies (2020):

```{r}
#| label: load in data set
#| message: false
#| warning: false

library(tidyverse)
library(tidymodels)

election_data <- read_csv("anes_timeseries_2020_csv_20220210.csv")

```

This study utilized data collected through 8,280 pre-election interviews and 7,499 post-election interviews from U.S. eligible voters. The data was obtained from Fresh Cross-Sectional and ANES 2016-2020 Panel, and the interview formats included website, phone calls, and internet video. Pre-election interviews took place between August 2020 and Election Day on November 3rd, while post-election interviews began shortly after and ended on December 31st. It is worth noting that the data set contains different variables depending on whether the response was pre or post-election.

The pre-election survey covered a wide range of topics, such as sexual harassment, health insurance, immigration, identity politics, media trust and misinformation, institutional legitimacy, campaigns, party images, trade tariffs, and tax policy. In contrast, the post-election survey focused on voting experiences, attitude towards public health officials and organizations, anti-elitism, faith in experts/science, climate change opinions, gun control opinions, opioids, rural/urban living, international trade, sexual harassment and MeToo, transgender military service, social media usage, opinions on misinformation, and personal experiences.

The research question driving our study is: "How does an individual's sex alignment and method of voting (by mail/absentee or in-person) relate to their 'thermometer' rating of the NRA?" The hypothesis is that female voters who voted by mail/absentee are more likely to have a 'thermometer' rating that disapproves of the NRA than male voters who voted in person.

Previous studies have found that universal vote-by-mail did not affect political parties' share of turnout or increase the vote share of either party. However, these studies were conducted before the 2020 election, when voting by mail was implemented in the US at a larger scale than ever before due to the COVID-19 pandemic. Therefore, our research aims to analyze whether voting by mail had a partisan impact in the 2020 election by examining highly-partisan thermometer ratings such as the NRA.

In the dataset, all variables were given specific source codes which we will be altering for the sake of readability. Looking at the categorical variables in the dataset, Sex has the code V201600, where the value of -9 means that the voter refused to provide information, while a 1 indicated they were Male, and a 2 indicated they were female. The variable Voting Method has the code V202117, where a value of -9 is refused, -8 is Don't know, -7 is No post-election data, deleted due to incomplete interview, -6. is No post-election interview, 1 is In person, at the polling place, and 2 is By mail or absentee ballot. For the sake of our analysis, were are assuming independence of observations, and focusing on 1 (In-person) and 2 (by mail or absentee). Finally, the quantitative variable of significance in our analysis of the thermometer rating of the NRA for each person. This is how a voter felt about this specific group after the election, where a 100 is total approval, while a 0 is total disapproval in sentiment.

**Methodology:**

First, we will mutate the variable names of the variables analyzed in this report to reflect their values.

```{r}
#| label: Mutate Variable Names

#V202178 - "Thermometer" rating of the NRA (1-100)
#V201600 - Sex {1 if male, 2 if female}
#V202117 - Voting Method {1 if in person; 2 if by mail}


election_data <- election_data |>
  mutate(Thermometer_Rating = V202178) |>
  mutate(Sex = V201600) |>
  mutate(Voting_Method = V202117)

```

Next, we've calculated the mean thermometer ratings of the NRA across different sexes and voting methods.

```{r}
#| label: Summary Statistics for data

#Entire Sample Mean NRA Thermometer Rating

election_data |>
  select(Thermometer_Rating, Sex, Voting_Method) |>
  filter(Sex == 1 | Sex == 2) |>
  filter(Thermometer_Rating >= 0 & Thermometer_Rating <= 100) |>
  filter(Voting_Method == 1 | Voting_Method == 2) |>
  summarize(NRA_Rating_Entire_Sample = mean(Thermometer_Rating))


#Sample Mean NRA Thermometer Rating across different sexes and voting methods

election_data |>
  select(Thermometer_Rating, Sex, Voting_Method) |>
  filter(Sex == 1 | Sex == 2) |>
  filter(Thermometer_Rating >= 0 & Thermometer_Rating <= 100) |>
  filter(Voting_Method == 1 | Voting_Method == 2) |>
  mutate(Sex = if_else(Sex == 1, "M", "F")) |>
  mutate(Voting_Method = if_else(Voting_Method == 1, "In-Person", "By Mail")) |>
  group_by(Sex, Voting_Method) |>
  summarize(mean_NRA_Thermometer_Rating = mean(Thermometer_Rating))

```

```{r}
#| label: Present specific variables of interest for anwering hypothesis
election_data |>
  select(Thermometer_Rating, Sex, Voting_Method)
```

It is possible to see non useful values in these variables. So we will need to filter it in the next code chunk.

We plan to answer the "How is whether an individual voted by mail/absentee and their sex (categorical) associated with their 'thermometer' rating of the NRA (quantitative)?" research question by creating a Bar Plot to visualize the research question.

```{r}
#| label: Visualization Individual choice to vote/Sex and thermometer rating of NRA

# We are filtering information from our three variables to get to our
# visualization only where it has occurrences with valid values using !is.na.
# By this method, it only includes relevant variables.
filt_election_isoccurence <- election_data |>
  filter(V202117 %in% c(1, 2)) |>
  filter(!is.na(V202117), !is.na(V201600), !is.na(V202178)) |>
  filter(V202178 >= 0 & V202178 <= 100)

# Group the data by sex and voting method, and calculate the mean
# thermometer rating.
election_grouped <- filt_election_isoccurence |>
  group_by(V201600, V202117) |>
  summarize(mean_thermometer = mean(V202178))

# Creating a bar plot to visualize the research question analysis.
# Using x and fill as categorical variables.
election_grouped |>
  ggplot(aes(
    x = factor(V202117),
    y = mean_thermometer,
    fill = factor(V201600)
  )) +
  geom_bar(stat = "identity", position = position_dodge()) +
  xlab("Voting Method (1 if in person; 2 if by mail)") +
  ylab("Mean Thermometer Rating of NRA") +
  ggtitle("Association between Voting Method, Sex, and NRA Thermometer Rating") +
  scale_fill_discrete(name = "Sex",
                      labels = c( "Non-Declared", "Male", "Female")) +
  theme_classic()

```

**Logistic Modeling:**

Now that we see a correlations from the graph between the NRA thermometer rating, sex, and voting method, we now want to look at the best fit logistic regression model using these variables. We will be trying to answer the question: How does the NRA thermometer rating (quantitative) and one's sex (binary) impact whether someone voted by mail (binary), and what is the best model to demonstrate this correlation?

Because our response variable (voting method) is categorical and binomial, the logistic model will be the best way to demonstrate relations with explanatory variables. We will use the predict function to predict, based off the logistic regression, the log odds of voting by mail given a thermometer rating and sex.

Furthermore, we will use the stepwise selection method of forward selection and look at the AIC value. This mean we will add variables one-at-a-time until we cannot improve the model any further.

Before we decide on the best model to use, we will create training and testing data sets, with 20% and 80% of the total observations respectfully:

```{r}
#| label: Create train and test data
set.seed(2)

#Filtering the data so only pertinent information is presented
election_data <- election_data |>
  filter(Thermometer_Rating >= 0 & Thermometer_Rating <= 100,
         Voting_Method %in% c(1, 2),
         Sex %in% c(1, 2)) |>
  mutate(Voting_Method = factor(Voting_Method),
         Sex = factor(Sex)) |>
  select(Thermometer_Rating, Voting_Method, Sex)

election_split <- initial_split(election_data, prop = 0.80)

train_data <- training(election_split)
test_data <- testing(election_split)

```

Using the training data, we will start by comparing the probability that a person voted by mail given a NRA thermometer rating:

```{r}
#| label: Logistic regression of data/answering question

#Voting Method {1 if in person; 2 if by mail} by "Thermometer" rating of the NRA (1-100)
election_model1 <- logistic_reg() |>
  set_engine("glm") |>
  fit(Voting_Method ~ Thermometer_Rating, data = train_data, family = "binomial")

glance(election_model1)$AIC

```

We receive an AIC value of 289.27 when modeling Thermometer Rating.

We hypothesize that sex and NRA thermometer rating change based on the probability that a person voted by mail. We believe that males are more likely to have a greater favorability of the NRA than females, and these variables would be best fitted with an interaction model. To test this hypothesis, we will identify the additive and interactive models of these variables and find their AIC values.

First we will calculate the additive model:

```{r}
#| label: Logistic regression 2 additive model

#Sex {1 if male, 2 if female} by "Thermometer" rating of the NRA (1-100)
election_model_additive <- logistic_reg() |>
  set_engine("glm") |>
  fit(Voting_Method ~ Thermometer_Rating + Sex, data = train_data, family = "binomial")

glance(election_model_additive)$AIC

```

This additive model creates an AIC value of 291.26.

Now we will calculate the interaction model:

```{r}
#| label: Logistic regression interactive model

#Sex {1 if male, 2 if female} by "Thermometer" rating of the NRA (1-100)
election_model_interaction <- logistic_reg() |>
  set_engine("glm") |>
  fit(Voting_Method ~ Thermometer_Rating * Sex, data = train_data, family = "binomial")

glance(election_model_interaction)$AIC

```

This results in an AIC value of 293.27.

Suprisingly, the AIC value of the additive model was less than the AIC value of the interaction model, which means that the additive model is a better model for predicting the log odds of Voting Method. However, even more surprisingly, the best model (the one with the lowest AIC value) is the model that only incorporates Thermometer Rating (not Sex).

```{r}
#| label: Print out information for creating equation

election_model1

election_fit <- election_model1
```

Given this information, the model demonstrates that:

$log(p/(1-p)) = 1.457 - 0.0096 * Thermometer\_Rating$

We will now evaluate our model using our test data.

```{r}
#| label: Create election_pred to use when creating ROC curve

election_pred <- predict(election_fit, test_data, type = "prob") |>
  bind_cols(test_data |> select(Voting_Method))  
```

We will now plot the ROC curve to see the difference tween the true positive rate and the false positive rate for election voting method:

```{r}
#| label: Create ROC curve

election_pred |>
  roc_curve(
    truth = Voting_Method, 
    .pred_2, 
    event_level = "second"
  ) |>
  autoplot()

```

From the graph alone, it appears that a large portion of the predicted line made correct decisions, as the graph is substantially on the right side of the straight line.

```{r}
#| label: Find the .estimate value (the total area under the graph)
election_pred |>
  roc_auc(
    truth = Voting_Method, 
    .pred_2, 
    event_level = "second" #which level is a success
  ) 
```

With an AUC value of 0.621 (which is well above 0.5), our ROC demonstrates that the area under the graph is much greater than 50%. This means that our chosen model does a much better job predicting the likelihood that someone voted by mail than random chance.

**Results**

Our research goal was to examine how an individual's voting method and gender identity relate to their "thermometer" rating of the National Rifle Association (NRA). We analyzed data from a substantial sample of 14,720 people who took part in the 2020 US presidential election.

Our analysis has revealed a significant difference between the average NRA rating of individuals who voted in-person and those who voted through mail/absentee ballots. We observed that those who voted by mail/absentee had a lower NRA rating (mean of 37.57, with a standard deviation of 30.62) in comparison to those who voted in-person (mean of 43.61, with a standard deviation of 31.60). The statistical evaluation demonstrated a t-value of -8.051 with a p-value of less than .001 and an effect size of -0.190.

Our research revealed a noteworthy relationship between gender alignment and the "thermometer" rating of the NRA. Specifically, males (M = 47.02, SD = 31.11) had a higher rating compared to females (M = 36.91, SD = 30.85), with a significant difference of t(14718) = 21.418, p \< .001, d = 0.503.

Furthermore, we examined the interaction between voting method and sex alignment on "thermometer" rating of the NRA. The results showed that the interaction effect was not statistically significant, F(1, 14716) = 2.152, p = .142. This suggests that the association between voting method and "thermometer" rating of the NRA was similar for both males and females.

Our best logistic regression model (according to the AIC values generated) revealed that as a voter's "thermometer" rating increased by one point, their probability in terms of log odds of voting by mail decreased by 0.0096. We arrived at this conclusion after analyzing the data and obtaining a Wald chi-square value of 9.889 and a p-value of .002. In other words, voters with higher "thermometer" ratings for the NRA tended to vote in person instead of by mail/absentee. Furthermore, with an AUC value of 0.621, the ROC of our best logistic regression model demonstrates that our chosen model does a significantly better job at predicting the likelihood that someone voted by mail than random chance.

**Discussion:**

Our study conclusively demonstrates that the voting method and sex have a direct correlation with how individuals rate the NRA on a "thermometer" scale. It is evident that those who voted by mail or absentee and females gave the NRA a significantly lower rating. We found no interaction between these factors, cementing the validity of our findings. Surprisingly, our best model only incorporated the thermometer rating as an explanatory variable for calculating the probability that a person voted by mail. This finding demonstrates that sentiment of the NRA has a stronger correlation with voting habits than sex.

It is important to note that there were limitations to the analysis conducted in this report. Our dataset failed to account for access to voting by mail across more conservative and more liberal states. This not only provides potential problems when assuming independence of observations, but also means that our conclusions are less accurate and less specific. Furthermore, large portions of the observations could not be used because they failed to provide essential information on all of the variables necessary to help answer our hypothesis. These limitations could be addressed with data that is more specific about where it is being drawn from (most likely by providing the state of the voter), with observations that each provide definitive information for all variables.

Our analysis offers critical insights for understanding the complex connections between voting habits, gender, and attitudes towards the NRA. Although our analysis focused on a specific subset of the data provided by the American National Election Studies, many other insights could be uncovered following a similar procedure to the one outlined above. Future work could use this same dataset to look at other subsections of the data and compare other variables to one another in order to paint a fuller picture of voting trends. Specifically to our findings, policymakers can use our analysis when developing targeted interventions that encourage voter participation and promote public support for gun control measures.

**Literature Review and Sources**

American National Election Studies. 2021. ANES 2020 Time Series Study Full Release dataset and documentation. July 19, 2021 version. www.electionstudies.org.

Thompson, D. M., Wu, J. A., Yoder, J., & Hall, A. B. (2020). Universal vote-by-mail has no impact on partisan turnout or vote share. *Proceedings of the National Academy of Sciences*, *117*(25), 14052--14056. https://doi.org/10.1073/pnas.2007249117

User Guide and Codebook for all variable information/descriptions: https://electionstudies.org/wp-content/uploads/2022/02/anes_timeseries_2020_userguidecodebook_20220210.pdf
